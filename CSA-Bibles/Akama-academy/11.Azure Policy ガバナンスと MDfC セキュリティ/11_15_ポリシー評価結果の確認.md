# ポリシー評価結果の確認

ポリシーの評価結果は、Azure ポータルの Azure Policy 画面からチェックすることもできますし、MDfC 推奨事項の画面から確認することもできます。

また他の方法として、ARG (Azure Resource Graph) に対してクエリを実行することもできます。具体的には以下のページの ARG クエリを利用します。

- https://learn.microsoft.com/en-us/azure/governance/policy/samples/resource-graph-samples?tabs=azure-cli
 
例えばリソース別 compliant 状態の確認例としては以下のようなクエリが利用できます。

```ARG
PolicyResources
|wheretype =='microsoft.policyinsights/policystates'
|extendcomplianceState = tostring(properties.complianceState)
| extend resourceId = tostring(properties.resourceId)
|summarizecount()byresourceId, complianceState
| order by ['complianceState'] asc
```

## （参考） 適用除外（Exemption）と是正（Remediation）について

ガバナンスを適切に行うためには、安易に適用を免除しないことが極めて重要です。

Azure Security Benchmark は CIS をベースに作成されており、指摘している事項は相応に根拠・理由があります。このため、適用除外するにしても、Waiver （軽減済み）なのか Mitigated （免除）なのかをはっきりさせることが重要です。

特に本番環境では、原則として Mitigated なし、とすることが重要です。守れないルール・ポリシーは実質的に機能しません。Mitigate が多発するならルールを見直す必要がある、と考えるのがよいでしょう。

また、Exemption と Remediation を効率的に行っていくため、組織として、適用除外ガイドラインや是正処理ライブラリを整備していくことをオススメします。ひな形となる Excel シートを readme.md に示しておきましたので、現場にてご活用ください。

![picture 1](./images/a9a3ee5d6e2771afa23e0a8e3bb85e6d6f1700d34e825836dc20e9f5b57ec578.png)  
